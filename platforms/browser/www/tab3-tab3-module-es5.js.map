{"version":3,"sources":["webpack:///src/app/tab3/tab3.page.html","webpack:///src/app/services/background-geo.service.ts","webpack:///src/app/tab3/tab3-routing.module.ts","webpack:///src/app/tab3/tab3.module.ts","webpack:///src/app/tab3/tab3.page.scss","webpack:///src/app/tab3/tab3.page.ts"],"names":["BackgroundGeoService","geolocation","toast","http","alert","authS","flag","i","created","config","desiredAccuracy","stationaryRadius","distanceFilter","debug","stopOnTerminate","notificationText","locationProvider","RAW_PROVIDER","startForeground","interval","fastestInterval","gps","configure","then","response","on","location","subscribe","coordinates","lat","latitude","lng","longitude","drawPolyline","mapa","setView","start","setDefaultPolyline","user","getUser","undefined","polyline","color","opacity","weight","addTo","stop","waterLevel","level","create","cssClass","header","subHeader","inputs","name","type","placeholder","id","buttons","text","role","handler","removeLayer","data","saveRoute","title","present","selected","label","value","checked","alertWater","onDidDismiss","routeTitle","console","log","getLatLngs","input","toGeoJSON","addRoute","dat","JSON","parse","status","createToastBottom","err","addLatLng","locate","maxZoom","attribution","setTimeout","invalidateSize","providedIn","routes","path","component","Tab3PageRoutingModule","imports","forChild","exports","Tab3PageModule","declarations","Tab3Page","storage","cargaMapa","linea","change","button","vistaMapa","createMap","line","startBackgroundGeolocation","stopBackgroundGeolocation","startLocation","stopLocation","selector","template"],"mappings":"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","file":"tab3-tab3-module-es5.js","sourcesContent":["export default \"<ion-header [translucent]=\\\"true\\\">\\n  <ion-toolbar class=\\\"background-toolbar\\\">\\n    <ion-title class=\\\"textColor\\\">\\n      Ruta\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n  <div id=\\\"mapa\\\" style=\\\"height: 75%; width: 150%;\\\"></div>\\n  <div class=\\\"changeButton\\\">\\n    <button style=\\\"background-color: transparent; max-width: 125px; max-height: 125px;\\\" block (click)=\\\"this.changeButton()\\\" >\\n      <ion-img src=\\\"assets/buttons/play.png\\\" *ngIf=\\\"this.change\\\"></ion-img>\\n      <ion-img src=\\\"assets/buttons/stop.png\\\" *ngIf=\\\"!this.change\\\"></ion-img>\\n    </button>\\n  </div>\\n\\n</ion-content>\\n\";","import { Injectable } from '@angular/core';\nimport { BackgroundGeolocation, BackgroundGeolocationConfig, BackgroundGeolocationEvents, BackgroundGeolocationLocationProvider, BackgroundGeolocationProvider, BackgroundGeolocationResponse } from '@ionic-native/background-geolocation/ngx';\nimport { NativeStorage } from '@ionic-native/native-storage/ngx';\nimport { AlertController } from '@ionic/angular';\nimport { geoJSON, Map, Polyline, tileLayer } from 'leaflet';\nimport { addListener } from 'process';\nimport { User } from '../model/User';\nimport { AuthService } from './auth.service';\nimport { HttpService } from './http.service';\nimport { ToastService } from './toast.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class BackgroundGeoService {\n\n  line: any;\n  flag = true;\n  polyline: Polyline;\n  mapa: Map;\n  coordinates: {\n    lat: any,\n    lng: any\n  };\n  user: User;\n  route: {\n    id: any,\n    title: string,\n    polyline: any\n  };\n  i: number = 0;\n  created = false;\n\n  config: BackgroundGeolocationConfig = {\n    desiredAccuracy: 10,\n    stationaryRadius: 20,\n    distanceFilter: 5,\n    debug: false, //  Activa un sonido mientras este activa, para poder comprobar su funcionamiento\n    stopOnTerminate: true, // borrar configuracion cuando la app termine(true)\n    notificationText: \"Localizacion activada...\",\n    locationProvider: BackgroundGeolocationLocationProvider.RAW_PROVIDER,\n    startForeground: true,\n    interval: 2000,\n    fastestInterval: 1000\n  };\n\n\n  constructor(\n    private geolocation: BackgroundGeolocation,\n    private toast: ToastService,\n    private http: HttpService,\n    private alert: AlertController,\n    private authS: AuthService) {\n    this.setDefaultPolyline();\n    this.user = this.authS.getUser();\n  }\n\n  public setDefaultPolyline() {\n    this.coordinates = {\n      lat: undefined,\n      lng: undefined\n    }\n    if (!this.created) {\n      this.polyline = new Polyline([], {\n        color: \"red\",\n        opacity: 0.5,\n        weight: 2.5\n      });\n    } else {\n      this.polyline = new Polyline([], {\n        color: \"red\",\n        opacity: 0.5,\n        weight: 2.5\n      }).addTo(this.mapa);\n    }\n  }\n\n\n\n  gps = this.geolocation.configure(this.config).then((response: BackgroundGeolocationResponse) => {\n    this.geolocation.on(BackgroundGeolocationEvents.location).subscribe((location: BackgroundGeolocationResponse) => {\n\n      if (!this.flag) {\n        this.coordinates = {\n          lat: location.latitude,\n          lng: location.longitude\n        }\n        if (this.coordinates && this.created) {\n          this.drawPolyline(this.coordinates);\n          this.mapa.setView(this.coordinates);\n        }\n      }\n\n    });\n    this.geolocation.start();\n    //this.geolocation.finish(); // SOLO IOS\n  });\n\n\n  public startBackgroundGeolocation() {\n    this.geolocation.start();\n    this.flag = false;\n  }\n\n  public async stopBackgroundGeolocation() {\n    this.geolocation.stop();\n    await this.waterLevel();\n    this.flag = true;\n  }\n\n  public async routeTitle(level: number) {\n    const alert = await this.alert.create({\n      cssClass: \"custom\",\n      header: \"Guardar Ruta\",\n      subHeader: \"Titulo de la ruta\",\n      inputs: [\n        {\n          name: \"title\",\n          type: \"text\",\n          placeholder: \"TÃ­tulo\",\n          id: \"routeTitle\"\n        }\n      ],\n      buttons: [\n        {\n          text: \"No\",\n          role: \"cancel\",\n          handler: () => {\n            this.mapa.removeLayer(this.polyline);\n            this.setDefaultPolyline();\n          }\n        },\n        {\n          text: \"Si\",\n          handler: (data) => {\n            this.saveRoute(data.title, level);\n            this.mapa.removeLayer(this.polyline);\n            this.setDefaultPolyline();\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n  public async waterLevel() {\n    let selected = -1;\n    const alertWater = await this.alert.create({\n      cssClass: \"custom\",\n      header: \"Nivel del agua\",\n      subHeader: \"Elija el nivel del agua actual\",\n      inputs: [\n        {\n          name: \"highLevel\",\n          type: \"radio\",\n          label: \"Nivel Optimo\",\n          value: \"1\",\n          checked: true\n        },\n        {\n          name: \"mediunLevel\",\n          type: \"radio\",\n          label: \"Nivel Medio\",\n          value: \"2\"\n        },\n        {\n          name: \"lowLevel\",\n          type: \"radio\",\n          label: \"Nivel Bajo\",\n          value: \"3\"\n        }\n      ],\n      buttons: [\n        {\n          text: \"No\",\n          role: \"cancel\",\n          handler: () => {\n            this.mapa.removeLayer(this.polyline);\n            this.setDefaultPolyline();\n          }\n        },\n        {\n          text: \"Si\",\n          handler: (data: number) => {\n            selected = data;\n          }\n        }\n      ]\n    });\n    await alertWater.present();\n    alertWater.onDidDismiss().then(() => {\n      this.routeTitle(selected);\n    });\n  }\n\n  public saveRoute(title, level) {\n    console.log(\"Me cagao 2 \" + this.polyline.getLatLngs());\n    let input = this.polyline.toGeoJSON();\n    this.http.addRoute(this.authS.getUser().id, title, input, level).then((data) => {\n      if (data) {\n        let dat = JSON.parse(data.data);\n        if (dat.status == \"0\") {\n          //Todo ok\n          this.setDefaultPolyline();\n        } else {\n          //Error guardando ruta\n          this.toast.createToastBottom(\"Error al guardar la ruta...\", true, 400, \"Danger\");\n        }\n      }\n    }).catch(err => {\n      this.toast.createToastBottom(\"Tiempo de espera agotado...\", true, 400, \"Danger\");\n    });\n  }\n\n  public drawPolyline(location) {\n    this.polyline.addTo(this.mapa);\n    this.polyline.addLatLng(location);\n  }\n\n  public createMap() {\n    this.created = true;\n    this.mapa = new Map(\"mapa\").locate({ setView: true, maxZoom: 20 });\n    tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n    }).addTo(this.mapa);\n    setTimeout(() => {\n      this.mapa.invalidateSize();\n    }, 400);\n    return this.mapa;\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { Tab3Page } from './tab3.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: Tab3Page,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class Tab3PageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Tab3Page } from './tab3.page';\nimport { ExploreContainerComponentModule } from '../explore-container/explore-container.module';\n\nimport { Tab3PageRoutingModule } from './tab3-routing.module';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    ExploreContainerComponentModule,\n    RouterModule.forChild([{ path: '', component: Tab3Page }]),\n    Tab3PageRoutingModule,\n  ],\n  declarations: [Tab3Page]\n})\nexport class Tab3PageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3RhYjMvdGFiMy5wYWdlLnNjc3MifQ== */\";","import { Component, OnInit } from '@angular/core';\nimport { NativeStorage } from '@ionic-native/native-storage/ngx';\nimport { Map, Polyline} from 'leaflet';\nimport { BackgroundGeoService } from '../services/background-geo.service';\n\n\n@Component({\n  selector: 'app-tab3',\n  templateUrl: 'tab3.page.html',\n  styleUrls: ['tab3.page.scss']\n})\nexport class Tab3Page implements OnInit {\n\n  mapa: Map\n  marcador: any\n  latlngs: any\n  cargaMapa = false\n  linea = undefined;\n  newLat: any\n  newLong: any\n  polyline:Polyline;\n  change: boolean = true;\n  button = \"assets/buttons/play.png\";\n\n  constructor(\n    private location: BackgroundGeoService,\n    private storage: NativeStorage) {\n  }\n\n  ngOnInit() {\n    if (!this.cargaMapa) {\n      this.vistaMapa();\n    }\n  }\n\n  ionViewWillEnter() {\n    if (!this.cargaMapa) {\n      this.vistaMapa();\n    }\n  }\n\n  public async vistaMapa() {\n    this.cargaMapa = true;\n    this.mapa = this.location.createMap();\n  }\n\n  public async refreshRoute() {\n    if (this.cargaMapa)\n      this.location.line.addTo(this.mapa);\n  }\n\n  public startLocation() {\n    this.location.startBackgroundGeolocation();\n\n  }\n\n  public stopLocation() {\n    this.location.stopBackgroundGeolocation();\n  }\n\n  public changeButton(){\n    if(this.change){\n      this.startLocation();\n      this.change = false;\n    }else{\n      this.change = true;\n      this.stopLocation();\n    }\n  }\n\n\n}\n"]}