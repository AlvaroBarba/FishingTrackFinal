{"version":3,"sources":["webpack:///src/app/tab3/tab3.page.html","webpack:///src/app/services/background-geo.service.ts","webpack:///src/app/tab3/tab3-routing.module.ts","webpack:///src/app/tab3/tab3.module.ts","webpack:///src/app/tab3/tab3.page.scss","webpack:///src/app/tab3/tab3.page.ts"],"names":["BackgroundGeoService","geolocation","storage","http","alert","authS","flag","i","created","config","desiredAccuracy","stationaryRadius","distanceFilter","debug","stopOnTerminate","notificationText","locationProvider","RAW_PROVIDER","startForeground","interval","fastestInterval","gps","configure","then","response","console","log","on","location","subscribe","coordinates","lat","latitude","lng","longitude","drawPolyline","mapa","setView","start","setDefaultPolyline","user","getUser","polyline","color","opacity","weight","addTo","stop","create","cssClass","header","subHeader","inputs","name","type","placeholder","id","buttons","text","role","handler","removeLayer","data","saveRoute","title","present","input","toGeoJSON","addRoute","dat","JSON","parse","status","error","result","err","addLatLng","locate","maxZoom","attribution","setTimeout","invalidateSize","providedIn","routes","path","component","Tab3PageRoutingModule","imports","forChild","exports","Tab3PageModule","declarations","Tab3Page","popover","cargaMapa","linea","undefined","change","button","vistaMapa","ev","createPopover","createMap","line","startBackgroundGeolocation","stopBackgroundGeolocation","startLocation","stopLocation","selector","template"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCaFA,oBAAoB;AAiC/B,sCAAoBC,WAApB,EACUC,OADV,EAEUC,IAFV,EAGUC,KAHV,EAIUC,KAJV,EAI8B;AAAA;;AAAA;;AAJV,eAAAJ,WAAA,GAAAA,WAAA;AACV,eAAAC,OAAA,GAAAA,OAAA;AACA,eAAAC,IAAA,GAAAA,IAAA;AACA,eAAAC,KAAA,GAAAA,KAAA;AACA,eAAAC,KAAA,GAAAA,KAAA;AAlCV,eAAAC,IAAA,GAAO,IAAP;AAaA,eAAAC,CAAA,GAAY,CAAZ;AACA,eAAAC,OAAA,GAAU,KAAV;AAEA,eAAAC,MAAA,GAAsC;AACpCC,2BAAe,EAAE,EADmB;AAEpCC,4BAAgB,EAAE,EAFkB;AAGpCC,0BAAc,EAAE,CAHoB;AAIpCC,iBAAK,EAAE,KAJ6B;AAKpCC,2BAAe,EAAE,IALmB;AAMpCC,4BAAgB,EAAC,0BANmB;AAOpCC,4BAAgB,EAAE,+GAAsCC,YAPpB;AAQpCC,2BAAe,EAAE,IARmB;AASpCC,oBAAQ,EAAE,IAT0B;AAUpCC,2BAAe,EAAE;AAVmB,WAAtC;AA6CA,eAAAC,GAAA,GAAM,KAAKpB,WAAL,CAAiBqB,SAAjB,CAA2B,KAAKb,MAAhC,EAAwCc,IAAxC,CAA6C,UAACC,QAAD,EAA6C;AAC9FC,mBAAO,CAACC,GAAR,CAAYF,QAAZ;;AACA,iBAAI,CAACvB,WAAL,CAAiB0B,EAAjB,CAAoB,qGAA4BC,QAAhD,EAA0DC,SAA1D,CAAoE,UAACD,QAAD,EAA6C;AAE/G,kBAAI,CAAC,KAAI,CAACtB,IAAV,EAAgB;AACd,qBAAI,CAACwB,WAAL,GAAmB;AACjBC,qBAAG,EAAEH,QAAQ,CAACI,QADG;AAEjBC,qBAAG,EAAEL,QAAQ,CAACM;AAFG,iBAAnB;;AAIA,oBAAI,KAAI,CAACJ,WAAL,IAAoB,KAAI,CAACtB,OAA7B,EAAsC;AACpC,uBAAI,CAAC2B,YAAL,CAAkB,KAAI,CAACL,WAAvB;;AACA,uBAAI,CAACM,IAAL,CAAUC,OAAV,CAAkB,KAAI,CAACP,WAAvB;AACD;AACF;AAEF,aAbD;;AAcA,iBAAI,CAAC7B,WAAL,CAAiBqC,KAAjB,GAhB8F,CAiB9F;;AACD,WAlBK,CAAN;AA1BI,eAAKC,kBAAL;AACF,eAAKC,IAAL,GAAY,KAAKnC,KAAL,CAAWoC,OAAX,EAAZ;AACD;;AAxC8B;AAAA;AAAA,+CA0CN;AACvB,iBAAKX,WAAL,GAAiB;AACfC,iBAAG,EAAE,IADU;AAEfE,iBAAG,EAAE;AAFU,aAAjB;;AAIA,gBAAG,CAAC,KAAKzB,OAAT,EAAiB;AACf,mBAAKkC,QAAL,GAAgB,IAAI,gDAAJ,CAAa,EAAb,EAAiB;AAC/BC,qBAAK,EAAE,KADwB;AAE/BC,uBAAO,EAAE,GAFsB;AAG/BC,sBAAM,EAAE;AAHuB,eAAjB,CAAhB;AAKD,aAND,MAMK;AACH,mBAAKH,QAAL,GAAgB,IAAI,gDAAJ,CAAa,EAAb,EAAiB;AAC/BC,qBAAK,EAAE,KADwB;AAE/BC,uBAAO,EAAE,GAFsB;AAG/BC,sBAAM,EAAE;AAHuB,eAAjB,EAIbC,KAJa,CAIP,KAAKV,IAJE,CAAhB;AAKD;AACF;AA5D8B;AAAA;AAAA,uDAqFK;AAClC,iBAAKnC,WAAL,CAAiBqC,KAAjB;AACA,iBAAKhC,IAAL,GAAY,KAAZ;AACD;AAxF8B;AAAA;AAAA,sDA0FU;;;;;;;;;AACvC,2BAAKL,WAAL,CAAiB8C,IAAjB;;AACc,6BAAM,KAAK3C,KAAL,CAAW4C,MAAX,CAAkB;AACpCC,gCAAQ,EAAE,QAD0B;AAEpCC,8BAAM,EAAE,cAF4B;AAGpCC,iCAAS,EAAC,qBAH0B;AAIpCC,8BAAM,EAAE,CACN;AACEC,8BAAI,EAAE,OADR;AAEEC,8BAAI,EAAE,MAFR;AAGEC,qCAAW,EAAE,QAHf;AAIEC,4BAAE,EAAE;AAJN,yBADM,CAJ4B;AAYpCC,+BAAO,EAAE,CACP;AACEC,8BAAI,EAAE,IADR;AAEEC,8BAAI,EAAE,QAFR;AAGEC,iCAAO,EAAE,mBAAM;AACb,kCAAI,CAACxB,IAAL,CAAUyB,WAAV,CAAsB,MAAI,CAACnB,QAA3B;;AACA,kCAAI,CAACH,kBAAL;AACD;AANH,yBADO,EASP;AACEmB,8BAAI,EAAE,IADR;AAEEE,iCAAO,EAAE,iBAACE,IAAD,EAAU;AACjB,kCAAI,CAACC,SAAL,CAAeD,IAAI,CAACE,KAApB;;AACA,kCAAI,CAAC5B,IAAL,CAAUyB,WAAV,CAAsB,MAAI,CAACnB,QAA3B;;AACA,kCAAI,CAACH,kBAAL;AACD;AANH,yBATO;AAZ2B,uBAAlB,CAAN;;;AAARnC,2B;;AA+BN,6BAAMA,KAAK,CAAC6D,OAAN,EAAN;;;AACA,2BAAK3D,IAAL,GAAY,IAAZ;;;;;;;;;AACD;AA7H8B;AAAA;AAAA,oCA+Hd0D,KA/Hc,EA+HP;AAAA;;AACtB,gBAAIE,KAAK,GAAG,KAAKxB,QAAL,CAAcyB,SAAd,EAAZ;AACE,iBAAKhE,IAAL,CAAUiE,QAAV,CAAmB,KAAK5B,IAAL,CAAUgB,EAA7B,EAAiCQ,KAAjC,EAAwCE,KAAxC,EAA+C3C,IAA/C,CAAoD,UAACuC,IAAD,EAAQ;AAC1D,kBAAIA,IAAJ,EAAU;AACR,oBAAIO,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWT,IAAI,CAACA,IAAhB,CAAV;;AACA,oBAAIO,GAAG,CAACG,MAAJ,IAAc,GAAlB,EAAuB;AACrB;AACA,wBAAI,CAACjC,kBAAL;AACD,iBAHD,MAGO;AACL;AACAd,yBAAO,CAACgD,KAAR,CAAcJ,GAAG,CAACK,MAAlB;AACD;AACF;AACF,aAXD,WAWS,UAAAC,GAAG,EAAE;AACZlD,qBAAO,CAACgD,KAAR,CAAcE,GAAd;AACD,aAbD;AAcD;AA/I4B;AAAA;AAAA,uCAiJX/C,QAjJW,EAiJD;AAC5BH,mBAAO,CAACC,GAAR,CAAYE,QAAZ;AACA,iBAAKc,QAAL,CAAcI,KAAd,CAAoB,KAAKV,IAAzB;AACA,iBAAKM,QAAL,CAAckC,SAAd,CAAwBhD,QAAxB;AACD;AArJ8B;AAAA;AAAA,sCAuJZ;AAAA;;AACjB,iBAAKpB,OAAL,GAAe,IAAf;AACA,iBAAK4B,IAAL,GAAY,IAAI,2CAAJ,CAAQ,MAAR,EAAgByC,MAAhB,CAAuB;AAAExC,qBAAO,EAAE,IAAX;AAAiByC,qBAAO,EAAE;AAA1B,aAAvB,CAAZ;AACA,sEAAU,oDAAV,EACE;AAAEC,yBAAW,EAAE;AAAf,aADF,EAEGjC,KAFH,CAES,KAAKV,IAFd;AAGA4C,sBAAU,CAAC,YAAM;AACf,oBAAI,CAAC5C,IAAL,CAAU6C,cAAV;AACD,aAFS,EAEP,GAFO,CAAV;AAGA,mBAAO,KAAK7C,IAAZ;AACD;AAjK8B;;AAAA;AAAA,S;;;;gBAZxB;;gBACA;;gBAMA;;gBALA;;gBAIA;;;;AAMIpC,0BAAoB,6DAHhC,iEAAW;AACVkF,kBAAU,EAAE;AADF,OAAX,CAGgC,GAApBlF,oBAAoB,CAApB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACTb,UAAMmF,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE;AAFb,OADqB,CAAvB;;UAWaC,qBAAqB;AAAA;AAAA,O;;AAArBA,2BAAqB,6DAJjC,+DAAS;AACRC,eAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,eAAO,EAAE,CAAC,4DAAD;AAFD,OAAT,CAIiC,GAArBH,qBAAqB,CAArB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCMAI,cAAc;AAAA;AAAA,O;;AAAdA,oBAAc,6DAX1B,+DAAS;AACRH,eAAO,EAAE,CACP,0DADO,EAEP,4DAFO,EAGP,0DAHO,EAIP,2GAJO,EAKP,6DAAaC,QAAb,CAAsB,CAAC;AAAEJ,cAAI,EAAE,EAAR;AAAYC,mBAAS,EAAE;AAAvB,SAAD,CAAtB,CALO,EAMP,0EANO,CADD;AASRM,oBAAY,EAAE,CAAC,mDAAD;AATN,OAAT,CAW0B,GAAdD,cAAc,CAAd;;;;;;;;;;;;;;;;ACrBb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCYFE,QAAQ;AAanB,0BAAoBC,OAApB,EACUjE,QADV,EAEU1B,OAFV,EAEkC;AAAA;;AAFd,eAAA2F,OAAA,GAAAA,OAAA;AACV,eAAAjE,QAAA,GAAAA,QAAA;AACA,eAAA1B,OAAA,GAAAA,OAAA;AAVV,eAAA4F,SAAA,GAAY,KAAZ;AACA,eAAAC,KAAA,GAAQC,SAAR;AAIA,eAAAC,MAAA,GAAkB,IAAlB;AACA,eAAAC,MAAA,GAAS,yBAAT;AAKC;;AAhBkB;AAAA;AAAA,qCAkBR;AACT,gBAAI,CAAC,KAAKJ,SAAV,EAAqB;AACnB,mBAAKK,SAAL;AACD;AACF;AAtBkB;AAAA;AAAA,6CAwBA;AACjB,gBAAI,CAAC,KAAKL,SAAV,EAAqB;AACnB,mBAAKK,SAAL;AACD;AACF;AA5BkB;AAAA;AAAA,sCA8BDC,EA9BC,EA8BG;;;;;;AACpB,2BAAKP,OAAL,CAAaQ,aAAb,CAA2BD,EAA3B;;;;;;;;;AACD;AAhCkB;AAAA;AAAA,sCAkCM;;;;;;AACvB,2BAAKN,SAAL,GAAiB,IAAjB;AACA,2BAAK1D,IAAL,GAAY,KAAKR,QAAL,CAAc0E,SAAd,EAAZ;;;;;;;;;AACD;AArCkB;AAAA;AAAA,yCAuCS;;;;;;AAC1B,0BAAI,KAAKR,SAAT,EACE,KAAKlE,QAAL,CAAc2E,IAAd,CAAmBzD,KAAnB,CAAyB,KAAKV,IAA9B;;;;;;;;;AACH;AA1CkB;AAAA;AAAA,0CA6CI;AACrBX,mBAAO,CAACC,GAAR,CAAY,uBAAZ;AACA,iBAAKE,QAAL,CAAc4E,0BAAd;AAED;AAjDkB;AAAA;AAAA,yCAmDG;AACpB/E,mBAAO,CAACC,GAAR,CAAY,sBAAZ;AACA,iBAAKE,QAAL,CAAc6E,yBAAd;AACD;AAtDkB;AAAA;AAAA,yCAwDA;AACjBhF,mBAAO,CAACC,GAAR,CAAY,iBAAZ;;AACA,gBAAG,KAAKuE,MAAR,EAAe;AACb,mBAAKS,aAAL;AACA,mBAAKT,MAAL,GAAc,KAAd;AACD,aAHD,MAGK;AACH,mBAAKA,MAAL,GAAc,IAAd;AACA,mBAAKU,YAAL;AACD;AACF;AAjEkB;;AAAA;AAAA,S;;;;gBARZ;;gBADA;;gBAFA;;;;AAWIf,cAAQ,6DALpB,gEAAU;AACTgB,gBAAQ,EAAE,UADD;AAETC,gBAAQ,EAAR;AAAA;AAAA,0FAFS;;;;AAAA,OAAV,CAKoB,GAARjB,QAAQ,CAAR","file":"tab3-tab3-module-es5.js","sourcesContent":["export default \"<ion-header [translucent]=\\\"true\\\">\\n  <ion-toolbar class=\\\"background-toolbar\\\">\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button (click)=\\\"showPopover($event)\\\">\\n        <ion-icon name=\\\"ellipsis-vertical\\\" class=\\\"iconos\\\">\\n        </ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n    <ion-title class=\\\"textColor\\\">\\n      RUTA\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n  <div id=\\\"mapa\\\" style=\\\"height: 75%; width: 150%;\\\"></div>\\n  <div class=\\\"changeButton\\\">\\n    <button style=\\\"background-color: transparent; max-width: 125px; max-height: 125px;\\\" block (click)=\\\"this.changeButton()\\\" >\\n      <ion-img src=\\\"assets/buttons/play.png\\\" *ngIf=\\\"this.change\\\"></ion-img>\\n      <ion-img src=\\\"assets/buttons/stop.png\\\" *ngIf=\\\"!this.change\\\"></ion-img>\\n    </button>\\n  </div>\\n\\n</ion-content>\\n\";","import { Injectable } from '@angular/core';\nimport { BackgroundGeolocation, BackgroundGeolocationConfig, BackgroundGeolocationEvents, BackgroundGeolocationLocationProvider, BackgroundGeolocationProvider, BackgroundGeolocationResponse } from '@ionic-native/background-geolocation/ngx';\nimport { NativeStorage } from '@ionic-native/native-storage/ngx';\nimport { AlertController } from '@ionic/angular';\nimport { Map, Polyline, tileLayer } from 'leaflet';\nimport { addListener } from 'process';\nimport { User } from '../model/User';\nimport { AuthService } from './auth.service';\nimport { HttpService } from './http.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class BackgroundGeoService {\n\n  line: any;\n  flag = true;\n  polyline: Polyline;\n  mapa: Map;\n  coordinates:{\n    lat:any,\n    lng:any\n  };\n  user: User;\n  route: {\n    id: any,\n    title: string,\n    polyline: any\n  };\n  i: number = 0;\n  created = false;\n\n  config: BackgroundGeolocationConfig = {\n    desiredAccuracy: 10,\n    stationaryRadius: 20,\n    distanceFilter: 5,\n    debug: false, //  Activa un sonido mientras este activa, para poder comprobar su funcionamiento\n    stopOnTerminate: true, // borrar configuracion cuando la app termine(true)\n    notificationText:\"Localizacion activada...\",\n    locationProvider: BackgroundGeolocationLocationProvider.RAW_PROVIDER,\n    startForeground: true,\n    interval: 2000,\n    fastestInterval: 1000\n  };\n\n\n  constructor(private geolocation: BackgroundGeolocation,\n    private storage: NativeStorage,\n    private http: HttpService,\n    private alert: AlertController,\n    private authS: AuthService) {\n      this.setDefaultPolyline();\n    this.user = this.authS.getUser();\n  }\n\n  public setDefaultPolyline(){\n    this.coordinates={\n      lat: null,\n      lng: null\n    }\n    if(!this.created){\n      this.polyline = new Polyline([], {\n        color: \"red\",\n        opacity: 0.5,\n        weight: 2.5\n      });\n    }else{\n      this.polyline = new Polyline([], {\n        color: \"red\",\n        opacity: 0.5,\n        weight: 2.5\n      }).addTo(this.mapa);\n    }\n  }\n\n\n\n  gps = this.geolocation.configure(this.config).then((response: BackgroundGeolocationResponse) => {\n    console.log(response);\n    this.geolocation.on(BackgroundGeolocationEvents.location).subscribe((location: BackgroundGeolocationResponse) => {\n\n      if (!this.flag) {\n        this.coordinates = {\n          lat: location.latitude,\n          lng: location.longitude\n        }\n        if (this.coordinates && this.created) {\n          this.drawPolyline(this.coordinates);\n          this.mapa.setView(this.coordinates);\n        }\n      }\n        \n    });\n    this.geolocation.start();\n    //this.geolocation.finish(); // SOLO IOS\n  });\n\n\n  public startBackgroundGeolocation() {\n    this.geolocation.start();\n    this.flag = false;\n  }\n\n  public async stopBackgroundGeolocation() {\n    this.geolocation.stop();\n    const alert = await this.alert.create({\n      cssClass: \"custom\",\n      header: \"Guardar Ruta\",\n      subHeader:\"Titulo de esta ruta\",\n      inputs: [\n        {\n          name: \"title\",\n          type: \"text\",\n          placeholder: \"Título\",\n          id: \"routeTitle\"\n        }\n      ],\n      buttons: [\n        {\n          text: \"No\",\n          role: \"cancel\",\n          handler: () => {\n            this.mapa.removeLayer(this.polyline);\n            this.setDefaultPolyline();\n          }\n        },\n        {\n          text: \"Si\",\n          handler: (data) => {\n            this.saveRoute(data.title);\n            this.mapa.removeLayer(this.polyline);\n            this.setDefaultPolyline();\n          }\n        }\n      ]\n    });\n    await alert.present();\n    this.flag = true;\n  }\n\n  public saveRoute(title) {\n    let input = this.polyline.toGeoJSON();\n      this.http.addRoute(this.user.id, title, input).then((data)=>{\n        if (data) {\n          let dat = JSON.parse(data.data);\n          if (dat.status == \"0\") {\n            //Todo ok\n            this.setDefaultPolyline();\n          } else {\n            //Error buscando usuario\n            console.error(dat.result);\n          }\n        }\n      }).catch(err=>{\n        console.error(err);\n      });\n    }\n\n  public drawPolyline(location) {\n    console.log(location);\n    this.polyline.addTo(this.mapa);\n    this.polyline.addLatLng(location);\n  }\n\n  public createMap() {\n    this.created = true;\n    this.mapa = new Map(\"mapa\").locate({ setView: true, maxZoom: 20 });\n    tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      { attribution: 'Map data © <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>' })\n      .addTo(this.mapa);\n    setTimeout(() => {\n      this.mapa.invalidateSize();\n    }, 400);\n    return this.mapa;\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { Tab3Page } from './tab3.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: Tab3Page,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class Tab3PageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Tab3Page } from './tab3.page';\nimport { ExploreContainerComponentModule } from '../explore-container/explore-container.module';\n\nimport { Tab3PageRoutingModule } from './tab3-routing.module';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    ExploreContainerComponentModule,\n    RouterModule.forChild([{ path: '', component: Tab3Page }]),\n    Tab3PageRoutingModule,\n  ],\n  declarations: [Tab3Page]\n})\nexport class Tab3PageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3RhYjMvdGFiMy5wYWdlLnNjc3MifQ== */\";","import { Component, OnInit } from '@angular/core';\nimport { NativeStorage } from '@ionic-native/native-storage/ngx';\nimport { Map, Polyline, tileLayer } from 'leaflet';\nimport { BackgroundGeoService } from '../services/background-geo.service';\nimport { PopoverService } from '../services/popover.service';\n\n\n@Component({\n  selector: 'app-tab3',\n  templateUrl: 'tab3.page.html',\n  styleUrls: ['tab3.page.scss']\n})\nexport class Tab3Page implements OnInit {\n\n  mapa: Map\n  marcador: any\n  latlngs: any\n  cargaMapa = false\n  linea = undefined;\n  newLat: any\n  newLong: any\n  polyline:Polyline;\n  change: boolean = true;\n  button = \"assets/buttons/play.png\";\n\n  constructor(private popover: PopoverService,\n    private location: BackgroundGeoService,\n    private storage: NativeStorage) {\n  }\n\n  ngOnInit() {\n    if (!this.cargaMapa) {\n      this.vistaMapa();\n    }\n  }\n\n  ionViewWillEnter() {\n    if (!this.cargaMapa) {\n      this.vistaMapa();\n    }\n  }\n\n  async showPopover(ev) {\n    this.popover.createPopover(ev);\n  }\n\n  public async vistaMapa() {\n    this.cargaMapa = true;\n    this.mapa = this.location.createMap();\n  }\n\n  public async refreshRoute() {\n    if (this.cargaMapa)\n      this.location.line.addTo(this.mapa);\n  }\n\n\n  public startLocation() {\n    console.log(\"Starting location....\");\n    this.location.startBackgroundGeolocation();\n\n  }\n\n  public stopLocation() {\n    console.log(\"Stoping location....\");\n    this.location.stopBackgroundGeolocation();\n  }\n\n  public changeButton(){\n    console.log(\"HOLAAAAAAAAAAAA\");\n    if(this.change){\n      this.startLocation();\n      this.change = false;\n    }else{\n      this.change = true;\n      this.stopLocation();\n    }\n  }\n\n\n}\n"]}