{"version":3,"sources":["webpack:///src/app/tab3/tab3.page.html","webpack:///src/app/services/background-geo.service.ts","webpack:///src/app/tab3/tab3-routing.module.ts","webpack:///src/app/tab3/tab3.module.ts","webpack:///src/app/tab3/tab3.page.scss","webpack:///src/app/tab3/tab3.page.ts"],"names":["BackgroundGeoService","geolocation","storage","http","alert","authS","flag","i","created","config","desiredAccuracy","stationaryRadius","distanceFilter","debug","stopOnTerminate","notificationText","locationProvider","RAW_PROVIDER","startForeground","interval","fastestInterval","gps","configure","then","response","console","log","on","location","subscribe","coordinates","lat","latitude","lng","longitude","drawPolyline","mapa","setView","start","setDefaultPolyline","user","getUser","polyline","color","opacity","weight","addTo","stop","create","cssClass","header","subHeader","inputs","name","type","placeholder","id","buttons","text","role","handler","removeLayer","data","saveRoute","title","present","input","toGeoJSON","addRoute","dat","JSON","parse","status","error","result","err","addLatLng","locate","maxZoom","attribution","setTimeout","invalidateSize","providedIn","routes","path","component","Tab3PageRoutingModule","imports","forChild","exports","Tab3PageModule","declarations","Tab3Page","cargaMapa","linea","undefined","change","button","vistaMapa","createMap","line","startBackgroundGeolocation","stopBackgroundGeolocation","startLocation","stopLocation","selector","template"],"mappings":"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","file":"tab3-tab3-module-es5.js","sourcesContent":["export default \"<ion-header [translucent]=\\\"true\\\">\\r\\n  <ion-toolbar class=\\\"background-toolbar\\\">\\r\\n    <ion-title class=\\\"textColor\\\">\\r\\n      Ruta\\r\\n    </ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content [fullscreen]=\\\"true\\\">\\r\\n  <div id=\\\"mapa\\\" style=\\\"height: 75%; width: 150%;\\\"></div>\\r\\n  <div class=\\\"changeButton\\\">\\r\\n    <button style=\\\"background-color: transparent; max-width: 125px; max-height: 125px;\\\" block (click)=\\\"this.changeButton()\\\" >\\r\\n      <ion-img src=\\\"assets/buttons/play.png\\\" *ngIf=\\\"this.change\\\"></ion-img>\\r\\n      <ion-img src=\\\"assets/buttons/stop.png\\\" *ngIf=\\\"!this.change\\\"></ion-img>\\r\\n    </button>\\r\\n  </div>\\r\\n\\r\\n</ion-content>\\r\\n\";","import { Injectable } from '@angular/core';\r\nimport { BackgroundGeolocation, BackgroundGeolocationConfig, BackgroundGeolocationEvents, BackgroundGeolocationLocationProvider, BackgroundGeolocationProvider, BackgroundGeolocationResponse } from '@ionic-native/background-geolocation/ngx';\r\nimport { NativeStorage } from '@ionic-native/native-storage/ngx';\r\nimport { AlertController } from '@ionic/angular';\r\nimport { Map, Polyline, tileLayer } from 'leaflet';\r\nimport { addListener } from 'process';\r\nimport { User } from '../model/User';\r\nimport { AuthService } from './auth.service';\r\nimport { HttpService } from './http.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class BackgroundGeoService {\r\n\r\n  line: any;\r\n  flag = true;\r\n  polyline: Polyline;\r\n  mapa: Map;\r\n  coordinates:{\r\n    lat:any,\r\n    lng:any\r\n  };\r\n  user: User;\r\n  route: {\r\n    id: any,\r\n    title: string,\r\n    polyline: any\r\n  };\r\n  i: number = 0;\r\n  created = false;\r\n\r\n  config: BackgroundGeolocationConfig = {\r\n    desiredAccuracy: 10,\r\n    stationaryRadius: 20,\r\n    distanceFilter: 5,\r\n    debug: false, //  Activa un sonido mientras este activa, para poder comprobar su funcionamiento\r\n    stopOnTerminate: true, // borrar configuracion cuando la app termine(true)\r\n    notificationText:\"Localizacion activada...\",\r\n    locationProvider: BackgroundGeolocationLocationProvider.RAW_PROVIDER,\r\n    startForeground: true,\r\n    interval: 2000,\r\n    fastestInterval: 1000\r\n  };\r\n\r\n\r\n  constructor(private geolocation: BackgroundGeolocation,\r\n    private storage: NativeStorage,\r\n    private http: HttpService,\r\n    private alert: AlertController,\r\n    private authS: AuthService) {\r\n      this.setDefaultPolyline();\r\n    this.user = this.authS.getUser();\r\n  }\r\n\r\n  public setDefaultPolyline(){\r\n    this.coordinates={\r\n      lat: null,\r\n      lng: null\r\n    }\r\n    if(!this.created){\r\n      this.polyline = new Polyline([], {\r\n        color: \"red\",\r\n        opacity: 0.5,\r\n        weight: 2.5\r\n      });\r\n    }else{\r\n      this.polyline = new Polyline([], {\r\n        color: \"red\",\r\n        opacity: 0.5,\r\n        weight: 2.5\r\n      }).addTo(this.mapa);\r\n    }\r\n  }\r\n\r\n\r\n\r\n  gps = this.geolocation.configure(this.config).then((response: BackgroundGeolocationResponse) => {\r\n    console.log(response);\r\n    this.geolocation.on(BackgroundGeolocationEvents.location).subscribe((location: BackgroundGeolocationResponse) => {\r\n\r\n      if (!this.flag) {\r\n        this.coordinates = {\r\n          lat: location.latitude,\r\n          lng: location.longitude\r\n        }\r\n        if (this.coordinates && this.created) {\r\n          this.drawPolyline(this.coordinates);\r\n          this.mapa.setView(this.coordinates);\r\n        }\r\n      }\r\n        \r\n    });\r\n    this.geolocation.start();\r\n    //this.geolocation.finish(); // SOLO IOS\r\n  });\r\n\r\n\r\n  public startBackgroundGeolocation() {\r\n    this.geolocation.start();\r\n    this.flag = false;\r\n  }\r\n\r\n  public async stopBackgroundGeolocation() {\r\n    this.geolocation.stop();\r\n    const alert = await this.alert.create({\r\n      cssClass: \"custom\",\r\n      header: \"Guardar Ruta\",\r\n      subHeader:\"Titulo de esta ruta\",\r\n      inputs: [\r\n        {\r\n          name: \"title\",\r\n          type: \"text\",\r\n          placeholder: \"Título\",\r\n          id: \"routeTitle\"\r\n        }\r\n      ],\r\n      buttons: [\r\n        {\r\n          text: \"No\",\r\n          role: \"cancel\",\r\n          handler: () => {\r\n            this.mapa.removeLayer(this.polyline);\r\n            this.setDefaultPolyline();\r\n          }\r\n        },\r\n        {\r\n          text: \"Si\",\r\n          handler: (data) => {\r\n            this.saveRoute(data.title);\r\n            this.mapa.removeLayer(this.polyline);\r\n            this.setDefaultPolyline();\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    await alert.present();\r\n    this.flag = true;\r\n  }\r\n\r\n  public saveRoute(title) {\r\n    let input = this.polyline.toGeoJSON();\r\n      this.http.addRoute(this.user.id, title, input).then((data)=>{\r\n        if (data) {\r\n          let dat = JSON.parse(data.data);\r\n          if (dat.status == \"0\") {\r\n            //Todo ok\r\n            this.setDefaultPolyline();\r\n          } else {\r\n            //Error buscando usuario\r\n            console.error(dat.result);\r\n          }\r\n        }\r\n      }).catch(err=>{\r\n        console.error(err);\r\n      });\r\n    }\r\n\r\n  public drawPolyline(location) {\r\n    console.log(location);\r\n    this.polyline.addTo(this.mapa);\r\n    this.polyline.addLatLng(location);\r\n  }\r\n\r\n  public createMap() {\r\n    this.created = true;\r\n    this.mapa = new Map(\"mapa\").locate({ setView: true, maxZoom: 20 });\r\n    tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n    }).addTo(this.mapa);\r\n    setTimeout(() => {\r\n      this.mapa.invalidateSize();\r\n    }, 400);\r\n    return this.mapa;\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { Tab3Page } from './tab3.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: Tab3Page,\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class Tab3PageRoutingModule {}\r\n","import { IonicModule } from '@ionic/angular';\r\nimport { RouterModule } from '@angular/router';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Tab3Page } from './tab3.page';\r\nimport { ExploreContainerComponentModule } from '../explore-container/explore-container.module';\r\n\r\nimport { Tab3PageRoutingModule } from './tab3-routing.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    IonicModule,\r\n    CommonModule,\r\n    FormsModule,\r\n    ExploreContainerComponentModule,\r\n    RouterModule.forChild([{ path: '', component: Tab3Page }]),\r\n    Tab3PageRoutingModule,\r\n  ],\r\n  declarations: [Tab3Page]\r\n})\r\nexport class Tab3PageModule {}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3RhYjMvdGFiMy5wYWdlLnNjc3MifQ== */\";","import { Component, OnInit } from '@angular/core';\r\nimport { NativeStorage } from '@ionic-native/native-storage/ngx';\r\nimport { Map, Polyline, tileLayer } from 'leaflet';\r\nimport { BackgroundGeoService } from '../services/background-geo.service';\r\n\r\n\r\n@Component({\r\n  selector: 'app-tab3',\r\n  templateUrl: 'tab3.page.html',\r\n  styleUrls: ['tab3.page.scss']\r\n})\r\nexport class Tab3Page implements OnInit {\r\n\r\n  mapa: Map\r\n  marcador: any\r\n  latlngs: any\r\n  cargaMapa = false\r\n  linea = undefined;\r\n  newLat: any\r\n  newLong: any\r\n  polyline:Polyline;\r\n  change: boolean = true;\r\n  button = \"assets/buttons/play.png\";\r\n\r\n  constructor(\r\n    private location: BackgroundGeoService,\r\n    private storage: NativeStorage) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    if (!this.cargaMapa) {\r\n      this.vistaMapa();\r\n    }\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    if (!this.cargaMapa) {\r\n      this.vistaMapa();\r\n    }\r\n  }\r\n\r\n\r\n  public async vistaMapa() {\r\n    this.cargaMapa = true;\r\n    this.mapa = this.location.createMap();\r\n  }\r\n\r\n  public async refreshRoute() {\r\n    if (this.cargaMapa)\r\n      this.location.line.addTo(this.mapa);\r\n  }\r\n\r\n\r\n  public startLocation() {\r\n    this.location.startBackgroundGeolocation();\r\n\r\n  }\r\n\r\n  public stopLocation() {\r\n    this.location.stopBackgroundGeolocation();\r\n  }\r\n\r\n  public changeButton(){\r\n    if(this.change){\r\n      this.startLocation();\r\n      this.change = false;\r\n    }else{\r\n      this.change = true;\r\n      this.stopLocation();\r\n    }\r\n  }\r\n\r\n\r\n}\r\n"]}